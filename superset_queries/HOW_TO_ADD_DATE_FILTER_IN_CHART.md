# Как добавить фильтр по дате прямо в Chart

Есть несколько способов добавить фильтр по дате в Chart в Superset:

## Способ 1: Добавить фильтр в разделе "Filters" в Chart (РЕКОМЕНДУЕТСЯ)

### Шаг 1: Обновите SQL-запрос

Текущий запрос уже включает `reactivation_date` в SELECT. Если вы используете старую версию, обновите запрос, чтобы включить дату.

### Шаг 2: В интерфейсе Chart Builder

1. В правой панели найдите раздел **"Filters"**
2. Нажмите **"+ Drop columns/metrics here or click"**
3. Выберите колонку **`reactivation_date`** из списка
4. Настройте фильтр:
   - **Filter type**: Выберите "Time range" или "Date range"
   - **Time range**: Выберите нужный период (например, "Last 30 days" или "Custom range")
   - Или используйте **Custom SQL**: `reactivation_date >= '2025-11-01' AND reactivation_date <= '2025-11-30'`
5. Фильтр будет применяться автоматически при обновлении Chart

### Шаг 3: Сохранение

1. Нажмите **"Run"** для проверки результатов
2. Нажмите **"SAVE"** для сохранения Chart

---

## Способ 2: Использование Time Range Filter в Query

Если колонка `reactivation_date` не отображается в списке фильтров:

1. В разделе **"Query"** найдите **"Time range"** (если доступно)
2. Выберите колонку `reactivation_date` как Time column
3. Установите нужный диапазон дат

---

## Способ 3: Добавление фильтра через Custom SQL в разделе Filters

1. В разделе **"Filters"** нажмите **"+ Add filter"**
2. Выберите **"Custom SQL"** или **"SQL"**
3. Введите условие:
   ```sql
   reactivation_date >= '2025-11-01' AND reactivation_date <= '2025-11-30'
   ```
4. Или используйте параметры:
   ```sql
   reactivation_date >= '{{ start_date }}' AND reactivation_date <= '{{ end_date }}'
   ```
   (требует настройки параметров в Query Settings)

---

## Способ 4: Создание Dataset и использование фильтров Dashboard

Если фильтры в Chart не работают:

1. Создайте **Dataset** на основе вашего SQL-запроса:
   - В SQL Lab выполните запрос
   - Нажмите **"Save"** → **"Save as dataset"**
   - Дайте имя Dataset (например, "Реактивации по периодам")

2. Создайте Chart на основе Dataset:
   - **Data** → **Charts** → **+ CHART**
   - Выберите созданный Dataset
   - Настройте визуализацию

3. Добавьте фильтр на Dashboard:
   - На Dashboard нажмите **"Edit dashboard"**
   - **"+ ADD FILTER"** → **"Date Range Filter"**
   - Выберите Dataset и колонку `reactivation_date`
   - Настройте Scoping для применения к Chart

---

## Важно

- Если вы видите колонку `reactivation_date` в списке колонок слева, вы можете использовать её для фильтрации
- Убедитесь, что тип колонки `reactivation_date` определен как **Date/Time** или **Temporal** в Dataset
- Фильтры в Chart применяются на уровне запроса, поэтому они работают быстрее, чем фильтры Dashboard

---

## Быстрый способ (если колонка уже есть в запросе)

1. В правой панели Chart Builder найдите раздел **"Filters"**
2. Перетащите колонку **`reactivation_date`** из левой панели в раздел **"Filters"**
3. Выберите тип фильтра: **"Time range"** или **"Date range"**
4. Установите нужный диапазон дат
5. Нажмите **"Run"** для применения фильтра

Фильтр будет сохранен вместе с Chart и будет применяться автоматически.

